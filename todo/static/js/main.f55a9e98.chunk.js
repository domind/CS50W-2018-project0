(this.webpackJsonpmaps=this.webpackJsonpmaps||[]).push([[0],{114:function(e,t,n){e.exports=n(293)},119:function(e,t,n){},288:function(e,t,n){},293:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),i=n(101),o=n.n(i),s=(n(119),n(66)),r=n(31),c=n.n(r),d=n(65),h=n(102),m=n(103),p=n(112),u=n(104),f=n(20),C=n(113),g=n(295),v=n(297),y=n(298),w=n(296),k=n(21),E=n(33),b=n(108),S=n(110),x=n(9),O=n(105);function M(e,t){return Math.log(t)/Math.log(e)}function P(e,t,n){for(var a=[],l=0;l<e.length;l++)a=a.concat(e[l]);var i=Math.min.apply(Math,a.map((function(e){return e[0]}))),o=Math.max.apply(Math,a.map((function(e){return e[0]}))),s=Math.min.apply(Math,a.map((function(e){return e[1]}))),r=Math.max.apply(Math,a.map((function(e){return e[1]}))),c=(i+o)/2,d=(s+r)/2,h=1852*(i-o)*60/t,m=M(2,156412/Math.abs(h)),p=Math.cos(c*Math.PI/180)*(s-r)*1852*60/n,u=M(2,156412/Math.abs(p)),f=Math.trunc(m>u?u:m-1);return f>20&&(f=20),f<0&&(f=0),{center:[c,d],zoom:f}}var N=n(106),j=n(5),D=n(32),L=Object(D.renderToStaticMarkup)(l.a.createElement("i",{style:{color:"green"},className:" fa fa-map-marker-alt fa-3x"})),A=Object(j.divIcon)({html:L,iconAnchor:[13,38]}),z=Object(D.renderToStaticMarkup)(l.a.createElement("i",{style:{color:"red"},className:" fa fa-map-marker-alt fa-3x"})),U=Object(j.divIcon)({html:z,iconAnchor:[13,38]}),W=Object(D.renderToStaticMarkup)(l.a.createElement("i",{style:{color:"red"},className:"fas fa-dot-circle"})),I=Object(j.divIcon)({html:W,iconAnchor:[6,8]}),F=Object(D.renderToStaticMarkup)(l.a.createElement("i",{style:{color:"blue"},className:" fa fa-map-marker-alt fa-3x"})),R=Object(j.divIcon)({html:F,iconAnchor:[13,38]});function V(e){return e.slice(4,6)+e.slice(2,4)+e.slice(0,2)}n(288),n(289),n(290);var q={center:[34.6638506,32.9142967],zoom:13},_=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(u.a)(t).call(this,e))).onViewportChanged=function(e){n.setState({viewport:e})},n.handleChangeComplete=function(e){n.setState({lineColorNew:e.hex});var t=n.state.originalColors;t[n.state.lineColors.indexOf("selected")]=n.state.lineColorNew,n.setState({originalColors:t})},n.handleClick=function(){n.setState({displayColorPicker:!n.state.displayColorPicker})},n.handleClose=function(){n.setState({displayColorPicker:!1})},n.parseKML=function(e){for(var t=[],a=(new DOMParser).parseFromString(e,"text/xml"),l=[],i=[],o=a.querySelectorAll("Placemark LineString "),s=0;s<a.querySelectorAll("Placemark  LineString").length;s++){var r=void 0;r="MultiGeometry"===o[s].parentElement.nodeName?o[s].parentElement.parentElement:o[s].parentElement,l.push(r.querySelector("name").firstChild.nodeValue);var c=a.getElementById(r.querySelector("styleUrl").firstChild.nodeValue.replace("#","")).querySelector("styleUrl").firstChild.nodeValue.replace("#","");i.push("#"+V(a.getElementById(c).querySelector("color").firstChild.nodeValue.slice(2)));var d=a.querySelectorAll("LineString coordinates")[s].childNodes[0].nodeValue.replace(/(\r\n|\n|\r|\t)/gm,"").split(/[ ,]+/);t[s]=[];for(var h=0;h<d.length/3-1;h++)t[s][h]=[Number(d[3*h+1]),Number(d[3*h])]}n.setState({points:t,lineNames:l,lineColors:i,originalColors:i}),n.setState({viewport:P(t,n.state.height-150,n.state.width/2)})},n.showFile=function(){var e=Object(d.a)(c.a.mark((function e(t){var a,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="",(l=new FileReader).onload=function(){var e=Object(d.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.result,n.setState({file:a},(function(){n.parseKML(n.state.file)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.readAsText(t[0].file);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDivide=function(){if(n.state.lineColors.includes("selected"))if(0===n.state.selectedPoint.length)alert("select division point");else{var e=n.state.points,t=n.state.lineColors.indexOf("selected"),a=n.state.points[t],l=n.state.selectedPoint[1],i=a.slice(0,l+1),o=a.slice(l);e[t]=i,e.push(o);var s=n.state.lineNames;s.push(n.state.lineNames[t]+"_2");var r=n.state.originalColors;r.push(function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()),n.setState({points:e,lineNames:s,lineColors:r,originalColors:r,selectedPoint:[]})}else alert("select path and division point")},n.handleReverse=function(){if(n.state.lineColors.includes("selected")){var e=n.state.lineColors.indexOf("selected"),t=n.state.points;t[e].reverse(),n.setState({points:t,selectedPoint:[]})}else alert("Please select path")},n.handleSave=function(){if(n.state.lineColors.includes("selected")){var e=n.state.lineColors.indexOf("selected"),t='<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2" xmlns:atom="http://www.w3.org/2005/Atom"><Document><name>'+n.state.lineNames[e]+'</name><StyleMap id="msn_ylw-pushpin92"><Pair><key>normal</key><styleUrl>#sn_ylw-pushpin10</styleUrl></Pair></StyleMap><Style id="sn_ylw-pushpin10"><LineStyle><color>ff'+V(n.state.originalColors[e].replace("#",""))+"</color><width>4</width></LineStyle></Style><Placemark><name>"+n.state.lineNames[e]+"</name><open>1</open><styleUrl>#msn_ylw-pushpin92</styleUrl><LineString><tessellate>1</tessellate><coordinates>"+n.state.points[e].map((function(e){return e[1]+","+e[0]+",0 "})).toString().replace(/0 ,/g,"0 ")+"</coordinates></LineString></Placemark></Document></kml>",a=document.createElement("a"),l=new Blob([t],{type:"xml/plain"});a.href=URL.createObjectURL(l),a.download=n.state.lineNames[e]+".kml",document.body.appendChild(a),a.click()}else alert("Please select path")},n.state={viewport:q,width:window.innerWidth,height:window.innerHeight,file:"",files:"",points:[],lineNames:[],lineColors:[],originalColors:[],selectedPoint:[],displayColorPicker:!1,lineColorNew:"#000000"},n.handleSave=n.handleSave.bind(Object(f.a)(n)),n.handleReverse=n.handleReverse.bind(Object(f.a)(n)),n.handleDivide=n.handleDivide.bind(Object(f.a)(n)),n.polylineClick=n.polylineClick.bind(Object(f.a)(n)),n.pointClick=n.pointClick.bind(Object(f.a)(n)),n.handleChangeComplete=n.handleChangeComplete.bind(Object(f.a)(n)),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(f.a)(n)),n}return Object(C.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"polylineClick",value:function(e){var t=e.target.options.idName,n=t.slice(0,t.indexOf("#"));if("selected"===this.state.lineColors[n])this.setState({lineColors:this.state.originalColors,selectedPoint:[],newLineColors:"white"});else{var a=Object(s.a)(this.state.originalColors);a[n]="selected",this.setState({lineColors:a,lineColorNew:this.state.originalColors[n]})}}},{key:"pointClick",value:function(e){for(var t,n=[e.target._latlng.lat,e.target._latlng.lng],a=0;a<this.state.points[this.state.lineColors.indexOf("selected")].length;a++)if(this.state.points[this.state.lineColors.indexOf("selected")][a][1]===n[1]&&this.state.points[this.state.lineColors.indexOf("selected")][a][0]===n[0]){t=a;break}this.setState({selectedPoint:[this.state.lineColors.indexOf("selected"),t]})}},{key:"render",value:function(){var e,t=this;if(this.state.lineColors.includes("selected")){var n=this.state.lineColors.indexOf("selected");(e=this.state.points[n].map((function(e,n){return l.a.createElement(g.a,{key:n,position:e,icon:I,onClick:t.pointClick})})))[0]=l.a.createElement(g.a,{key:0,position:this.state.points[n][0],icon:A}),e[e.length-1]=l.a.createElement(g.a,{key:e.length-1,position:this.state.points[n][e.length-1],icon:U})}return l.a.createElement(b.a,null,l.a.createElement(k.a,null,l.a.createElement(x.a,{style:{textAlign:"center"}},l.a.createElement("h1",null,"KML path editor"))),l.a.createElement(k.a,null,l.a.createElement(x.a,{xs:4},l.a.createElement(k.a,null,l.a.createElement(x.a,null,"Upload your klm file here",l.a.createElement(O.FilePond,{ref:function(e){return t.pond=e},files:this.state.files,allowMultiple:!1,maxFiles:1,onupdatefiles:function(e){0===e.length?(console.log("empty"),t.setState({file:"",files:"",points:[],lineColors:[],originalColors:[],selectedPoint:[],lineNames:[]})):(t.showFile(e),t.setState({files:e.map((function(e){return e.file}))}))}}))),l.a.createElement(k.a,null,l.a.createElement("br",null)),this.state.lineNames.length>0?l.a.createElement("div",null,"List of paths:",l.a.createElement(k.a,null,l.a.createElement(x.a,null,l.a.createElement(S.a,{bordered:!0},l.a.createElement("tbody",null,this.state.lineNames.map((function(e,n){return l.a.createElement("tr",{key:n},l.a.createElement("td",{style:{backgroundColor:t.state.originalColors[n]},key:n}),l.a.createElement("td",null,"selected"===t.state.lineColors[n]?l.a.createElement("b",null,e):e))})))))),this.state.lineColors.includes("selected")?l.a.createElement("div",null,"Actions for selected line",l.a.createElement(k.a,null,l.a.createElement(x.a,{xs:4},l.a.createElement("div",null,l.a.createElement(E.a,{onClick:this.handleClick,size:"sm",variant:"outline-dark"},"Pick Color"),this.state.displayColorPicker?l.a.createElement("div",{style:{position:"absolute",zIndex:"2"}},l.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:this.handleClose}),l.a.createElement(N.SketchPicker,{color:this.state.lineColorNew,disableAlpha:!0,onChangeComplete:this.handleChangeComplete})):null)),l.a.createElement(x.a,{xs:2}),l.a.createElement(x.a,{xs:4},l.a.createElement(E.a,{size:"sm",variant:"outline-dark",onClick:this.handleReverse},"Reverse"))),l.a.createElement(k.a,null,l.a.createElement(x.a,null,l.a.createElement("br",null))),l.a.createElement(k.a,null,l.a.createElement(x.a,{xs:4},l.a.createElement(E.a,{size:"sm",variant:"outline-dark",onClick:this.handleDivide},"Divide")),l.a.createElement(x.a,{xs:2}),l.a.createElement(x.a,{xs:4},l.a.createElement(E.a,{size:"sm",variant:"outline-primary",onClick:this.handleSave},"Save")),l.a.createElement(x.a,null,l.a.createElement("br",null))),l.a.createElement(k.a,null)):"Select path you want to change or save"):" "),l.a.createElement(x.a,{xs:8},l.a.createElement(v.a,{onViewportChanged:this.onViewportChanged,style:{height:this.state.height-150>150?this.state.height-150:150,width:this.state.width/2},viewport:this.state.viewport},l.a.createElement(y.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),l.a.createElement(y.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.points.map((function(e,n){return l.a.createElement("div",{key:n},l.a.createElement(w.a,{key:n,color:t.state.originalColors[n],width:3,idName:n+"#"+t.state.lineNames[n].replace(/ /g,""),positions:Object(s.a)(e),onClick:t.polylineClick}))})),e,0!==this.state.selectedPoint.length?l.a.createElement(g.a,{position:this.state.points[this.state.selectedPoint[0]][this.state.selectedPoint[1]],icon:R}):""))))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[114,1,2]]]);
//# sourceMappingURL=main.f55a9e98.chunk.js.map